<html><head><title>PDI2</title><style type="text/css">ol{margin:0;padding:0}p{margin:0}.c17{vertical-align:top;width:57.0pt;border-style:solid;border-color:#000000;border-width:1.0pt;padding:5.0pt 5.0pt 5.0pt 5.0pt}.c14{vertical-align:top;width:57.75pt;border-style:solid;border-color:#000000;border-width:1.0pt;padding:5.0pt 5.0pt 5.0pt 5.0pt}.c0{color:#000000;font-size:14pt;font-family:Arial;font-weight:bold}.c2{line-height:1.15;text-indent:0pt;text-align:justify;direction:ltr}.c4{color:#000000;font-size:12pt;font-family:Arial;font-weight:bold}.c7{color:#000099;font-size:11pt;text-decoration:underline;font-family:Arial}.c11{color:#000000;font-size:24pt;font-family:Arial;font-weight:bold}.c6{color:#000000;font-size:11pt;font-family:Arial}.c8{color:#000000;font-size:11pt;font-family:Courier New}.c16{color:#0000ff;font-size:11pt;font-family:Courier New}.c26{color:#000000;font-size:18pt;font-family:Arial}.c1{line-height:1.0;text-indent:0pt;direction:ltr}.c13{color:#000000;font-size:14pt;font-family:Arial}.c3{line-height:1.15;text-indent:0pt;direction:ltr}.c31{line-height:1.15;text-indent:36.0pt;direction:ltr}.c24{height:1px;width:33%}.c5{padding-top:14.0pt;padding-bottom:4.0pt}.c28{padding-top:12.0pt;padding-bottom:2.0pt}.c29{padding-top:11.0pt;padding-bottom:2.0pt}.c9{padding-top:18.0pt;padding-bottom:4.0pt}.c22{padding-top:24.0pt;padding-bottom:6.0pt}.c21{margin-left:-51.0pt}.c25{background-color:#ffffff}.c23{margin-left:90.0pt}.c10{margin-left:54.0pt}.c19{font-style:italic}.c15{font-weight:bold}.c30{border-collapse:collapse}.c18{text-align:right}.c12{margin-left:72.0pt}.c20{height:0pt}.c27{margin-left:36.0pt}</style></head><body class="c25"><p class="c3 c22"><a name="h.st7qie-acs8p7"></a><span class="c11">Procesamiento de Im&aacute;genes II</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c7">&nbsp;</span></p><p class="c3 c27"><span class="c7"><a href="#h.ha6xl6-i8ill9">Implementaci&oacute;n</a></span></p><p class="c3 c10"><span class="c7"><a href="#h.dzhy01-1rulol">Diagrama de Clases</a></span></p><p class="c3 c10"><span class="c7"><a href="#h.1bnerk-ss02eq">Carga, correcci&oacute;n, conversi&oacute;n y ajuste de rango din&aacute;mico de las im&aacute;genes.</a></span></p><p class="c3 c12"><span class="c7"><a href="#h.ed3ff6-pg37bt">Banda 6 de Landsat 5</a></span></p><p class="c3 c10"><span class="c7"><a href="#h.9arzsa-bdbvx4">Falso Color</a></span></p><p class="c3 c12"><span class="c7"><a href="#h.ig80v9-ymzfnn">Mostrar rangos espec&iacute;ficos</a></span></p><p class="c3 c10"><span class="c7"><a href="#h.5bilnc-7of7p7">Detecci&oacute;n de bordes</a></span></p><p class="c3 c12"><span class="c7"><a href="#h.427yv2-o772y0">Implementaci&oacute;n</a></span></p><p class="c3 c23"><span class="c7"><a href="#h.woyv2v-s1kuma">Pseudoc&oacute;digo</a></span></p><p class="c3 c10"><span class="c7"><a href="#h.bas720-kz8xg4">Firma Espectral</a></span></p><p class="c3 c27"><span class="c7"><a href="#h.p9de2a-7tsa94">Otros aspectos de la aplicaci&oacute;n</a></span></p><p class="c3 c10"><span class="c7"><a href="#h.vsmnr0-ssp6tn">Bit&aacute;cora</a></span></p><p class="c3 c10"><span class="c7"><a href="#h.cm835e-wfzzyd">Cabecera de la imagen</a></span></p><p><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3 c18"><span class="c13">Gabriel Alvarez</span></p><p class="c3 c18"><span class="c6">&nbsp;</span></p><hr style="page-break-before:always;display:none;"><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3 c9"><a name="h.t0vi0v-e94wa5"></a><span class="c15 c26">Implementaci&oacute;n</span></p><p class="c2"><span class="c6">Se modelo el programa con POO ya que es de la forma en que mas naturalmente se resolv&iacute;a el problema.</span></p><p class="c2"><span class="c6">La funcionalidad de base para trabajar con la imagen satelital se abstrajo en un paquete de utilidad para facilitar su reuso en la construcci&oacute;n de otras aplicaciones o el cambio de bibliotecas de la interfaz de usuario.</span></p><p class="c3 c5"><a name="h.dzhy01-1rulol"></a><span class="c0">Diagrama de Clases</span></p><p class="c3 c21"><img height="514.0" src="images/drawing2.png" width="771.0"></p><p class="c3 c21"><span class="c6">&nbsp;</span></p><p class="c2 c21"><span class="c6">Esta programado en c/c++ y la parte de utilidad de base utiliza </span><span class="c6 c19">gobject</span><span class="c6">, la interfaz del usuario </span><span class="c6 c19">gtkmm (binding para c++ de GTK+)</span></p><p class="c3 c21"><span class="c6">&nbsp;</span></p><p class="c3 c5"><a name="h.1bnerk-ss02eq"></a><span class="c0">Carga, correcci&oacute;n, conversi&oacute;n y ajuste de rango din&aacute;mico de las im&aacute;genes.</span></p><p class="c3 c18"><img height="225.0" src="images/image5.png" width="369.0"></p><p class="c3 c18"><span class="c6">Vista de la ventana de elegir bandas y correcciones</span></p><p class="c2"><span class="c6">&nbsp;</span></p><p class="c2"><span class="c6">Para hacer velozmente las correcciones y el ajuste de rango din&aacute;mico de la imagen se convierten las m&uacute;ltiples y complejas ecuaciones en una multiplicaci&oacute;n y una suma para cada pixel de cada banda aprovechando que el </span><span class="c6 c19">numero digital (ND)</span><span class="c6"> es operado linealmente en todos los casos.</span></p><p class="c2"><span class="c6">Con un ejemplo se va a entender mas claro, veamos el caso de reflactancia:</span></p><p class="c2"><span class="c6">En cada banda el m&aacute;ximo y m&iacute;nimo </span><span class="c6 c19">ND </span><span class="c6">ser&aacute; 255 y 0 respectivamente, &eacute;stos multiplicados por el </span><span class="c6 c19">gain</span><span class="c6"> y sumando el </span><span class="c6 c19">bias</span><span class="c6"> dar&aacute;n un m&aacute;ximo y m&iacute;nimo para la banda, haciendo este proceso para todas las bandas que se quieran ver se obtienen un m&aacute;ximo y m&iacute;nimo de la im&aacute;gen.</span><sup class="c6"><a href="#ftnt1" name="ftnt_ref1">[1]</a></sup></p><p class="c2"><span class="c6">&nbsp;</span></p><p class="c2"><span class="c6">Sabiendo que debo ajustar esos m&aacute;ximo y m&iacute;nimo de la imagen a 255 y 0; con la ecuaci&oacute;n de la recta que pasa por dos puntos podemos calcular valores de pendiente y ordenada al origen, para ajustar el valor corregido de cualquier banda a los valores apropiados para representar.</span></p><p class="c3"><img height="228.0" src="images/drawing1.png" width="357.0"></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c2"><span class="c6">Por cada banda tambi&eacute;n puedo calcular una pendiente y ordenada al origen para encontrar la recta que map&eacute;a desde el </span><span class="c6 c19">ND </span><span class="c6">0 al 255 con los valores m&iacute;nimo y m&aacute;ximo de esa banda &nbsp;y as&iacute; aplicar las correcciones de una forma mucho mas performante.</span></p><p class="c3"><img height="227.0" src="images/drawing0.png" width="360.0"></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c2"><span class="c6">Y entonces, combinando esas dos rectas obtengo una tercera, con la que, con su pendiente y ordenada al origen convertir&eacute; los valores de los </span><span class="c6 c19">ND</span><span class="c6"> a los valores que debo pintar en la pantalla en un solo paso.</span></p><p class="c3"><img height="230.0" src="images/drawing3.png" width="356.0"></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">Imagen mostrando las bandas 4 6 2</span></p><p class="c3"><img height="469.0" src="images/image1.png" width="623.0"></p><p class="c3"><span class="c6"> (banda 4 verde banda 6 rojo bajda 2 azul)</span></p><p class="c3 c28"><a name="h.ed3ff6-pg37bt"></a><span class="c4">Banda 6 de Landsat 5</span></p><p class="c2"><span class="c6">Al aplicar la correcci&oacute;n del efecto rayleigh en la banda 6, como para esta no tiene sentido el concepto de Irradiancia solar al tope de la atm&oacute;sfera, se estableci&oacute; un valor arbitrario de 100 para procesarla junto con las dem&aacute;s bandas</span></p><p class="c3 c5"><a name="h.9arzsa-bdbvx4"></a><span class="c0">Falso Color</span></p><p class="c3 c18"><img height="186.0" src="images/image10.png" width="287.0"></p><p class="c3 c18"><span class="c6">Vista de la ventana de configuraci&oacute;n de Falso</span></p><p class="c3 c18"><span class="c6">Color con selecci&oacute;n de rangos visibles</span></p><p class="c3 c28"><a name="h.ig80v9-ymzfnn"></a><span class="c4">Mostrar rangos espec&iacute;ficos</span></p><p class="c2"><span class="c6">En la pantalla de configuraci&oacute;n de falso color se agrego por cada canal de color la posibilidad de establecer valores m&iacute;nimo y m&aacute;ximo para determinar si un pixel se pinta o no de ese color acorde a su valor. Esto puede ser utilizado para resaltar diferentes tipos de cubiertas en la im&aacute;gen.</span></p><p class="c2"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">Imagen con filtrado por rangos mostrando el verde solo para valores mayores que 90 y abajo misma imagen sin filtrar</span></p><p class="c2"><img height="317.0" src="images/image6.png" width="647.0"></p><p class="c2"><img height="263.0" src="images/image2.png" width="645.0"></p><p class="c2 c5"><a name="h.5bilnc-7of7p7"></a><span class="c0">Detecci&oacute;n de bordes</span></p><p class="c2"><span class="c6">Para la detecci&oacute;n de bordes se utiliza un operador similar al sobel, la diferencia con &eacute;ste es que al producto de las matrices no lo eleva al cuadrado para sumarlo y obtener la ra&iacute;z cuadrada, sino que suma los valores absolutos de multiplicar las matrices y lo divide entre 6. Si el resultado es mayor que 10 pinta el pixel de blanco, sino no.</span></p><p class="c2"><span class="c6">Esta molificaci&oacute;n sobre el operador sobel es para que sea mas r&aacute;pido el c&aacute;lculo, ya que se calcula en tiempo real sobre la imagen mostrada y no es cr&iacute;tica la exactitud del resultado.</span></p><p class="c3 c18"><img height="297.0" src="images/image9.png" width="445.0"></p><p class="c3 c18"><span class="c6">Vista de una imagen en la que se muestran</span></p><p class="c3 c18"><span class="c6"> solamente los bordes de las bandas cargadas</span></p><p class="c3 c28"><a name="h.427yv2-o772y0"></a><span class="c4">Implementaci&oacute;n</span></p><p class="c3"><span class="c6">Se itera en todos los pixeles mostrado y se pinta el pixel si el valor absoluto de la suma de los pixeles que lo rodean, ponderados tal como se muestra en esta tabla (matriz H)</span></p><p class="c3"><span class="c6">&nbsp;</span></p><table cellpadding="0" cellspacing="0" class="c30"><tbody><tr class="c20"><td class="c17"><p class="c1"><span class="c6">1</span></p></td><td class="c17"><p class="c1"><span class="c6">2</span></p></td><td class="c14"><p class="c1"><span class="c6">1</span></p></td></tr><tr class="c20"><td class="c17"><p class="c1"><span class="c6">0</span></p></td><td class="c17"><p class="c1"><span class="c6">0</span></p></td><td class="c14"><p class="c1"><span class="c6">0</span></p></td></tr><tr class="c20"><td class="c17"><p class="c1"><span class="c6">-1</span></p></td><td class="c17"><p class="c1"><span class="c6">-2</span></p></td><td class="c14"><p class="c1"><span class="c6">-1</span></p></td></tr></tbody></table><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3"><span class="c6">sumando al valor absoluto de la suma de los pixeles que rodean al punto ponderados con esta otra tabla (matriz V)</span></p><table cellpadding="0" cellspacing="0" class="c30"><tbody><tr><td class="c14"><p class="c1"><span class="c6">-1</span></p></td><td class="c17"><p class="c1"><span class="c6">0</span></p></td><td class="c14"><p class="c1"><span class="c6">1</span></p></td></tr><tr class="c20"><td class="c14"><p class="c1"><span class="c6">-2</span></p></td><td class="c17"><p class="c1"><span class="c6">0</span></p></td><td class="c14"><p class="c1"><span class="c6">2</span></p></td></tr><tr class="c20"><td class="c14"><p class="c1"><span class="c6">-1</span></p></td><td class="c17"><p class="c1"><span class="c6">0</span></p></td><td class="c14"><p class="c3"><span class="c6">1</span></p></td></tr></tbody></table><p class="c1"><span class="c6">&nbsp;</span></p><p class="c1"><span class="c6">dividido entre 6 es mayor que 10.</span></p><p class="c1 c29"><a name="h.woyv2v-s1kuma"></a><span class="c6 c15">Pseudoc&oacute;digo</span></p><p class="c1"><span class="c6">&nbsp;</span></p><p class="c1"><span class="c8">para cada pixel mostrado{</span></p><p class="c1"><span class="c8"> &nbsp;</span><span class="c16">pintaPixel</span><span class="c8">=falso</span></p><p class="c1"><span class="c8"> &nbsp;para cada banda cargada{</span></p><p class="c1"><span class="c8"> &nbsp; &nbsp;</span><span class="c16">valor</span><span class="c8"> = valor absoluto de (multiplicar matriz H por los pixeles</span></p><p class="c1"><span class="c8"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;que rodean al pixel)</span></p><p class="c1"><span class="c8"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+ valor absoluto de (multiplicar matriz V por los pixeles</span></p><p class="c1"><span class="c8"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;que rodean al pixel)</span></p><p class="c1"><span class="c8"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/ 6</span></p><p class="c1"><span class="c8"> &nbsp; &nbsp;si </span><span class="c16">valor</span><span class="c8"> &gt; 10</span></p><p class="c1"><span class="c8"> &nbsp; &nbsp; &nbsp; </span><span class="c16">pintaPixel</span><span class="c8"> = verdadero</span></p><p class="c1"><span class="c8"> &nbsp;}</span></p><p class="c1"><span class="c8"> &nbsp;si </span><span class="c16">pintaPixel</span></p><p class="c1"><span class="c8"> &nbsp; &nbsp; pintar pixel de blanco</span></p><p class="c1"><span class="c8">}</span></p><p class="c1"><span class="c8">&nbsp;</span></p><p class="c3"><span class="c6">Imagen con detecci&oacute;n de bordes activada</span></p><p class="c1"><img height="477.0" src="images/image11.png" width="637.0"></p><p class="c3"><span class="c0">&nbsp;</span></p><p class="c1"><span class="c0">Zoom</span></p><p class="c3"><span class="c6">Para hacer el zoom performante solo se multiplica por n&uacute;meros enteros (en el zoom para alejar) o se divide por 2 (en el zoom para acercar)</span></p><p class="c3"><img height="291.0" src="images/image7.png" width="283.0"><span class="c6"> </span><img height="292.0" src="images/image3.png" width="285.0"></p><p class="c27 c31"><span class="c6">Zoom para alejar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Zoom para acercar</span></p><p class="c3 c5"><a name="h.bas720-kz8xg4"></a><span class="c0">Firma Espectral</span></p><p class="c2"><span class="c6">Se implemento funcionalidad para mostrar la firma espectral del pixel bajo el puntero, en la ventana que muestra el gr&aacute;fico se muestra el valor en rango din&aacute;mico para ser representado en cada banda, y en la barra de estado se da informaci&oacute;n del valor calculado con la correcci&oacute;n elegida al cargar la imagen. Para mostrar este valor se vuelve &ldquo;para atras&rdquo; el valor ajustado al rango din&aacute;mico con una operaci&oacute;n inversa a la explicada en el principio.</span></p><p class="c3 c18"><img height="297.0" src="images/image8.png" width="371.0"></p><p class="c3 c18"><span class="c6">Firma espectral y barra de estado mostrando</span></p><p class="c3 c18"><span class="c6"> los valores para el pixel bajo el puntero</span></p><hr style="page-break-before:always;display:none;"><p class="c3 c9"><a name="h.p9de2a-7tsa94"></a><span class="c26 c15">Otros aspectos de la aplicaci&oacute;n</span></p><p class="c3 c5"><a name="h.vsmnr0-ssp6tn"></a><span class="c0">Bit&aacute;cora</span></p><p class="c3"><img height="569.0" src="images/image0.png" width="677.0"></p><p class="c3"><span class="c6">Versi&oacute;n para windows de la aplicaci&oacute;n mostrando la pantalla de elecci&oacute;n de bandas y atr&aacute;s la bit&aacute;cora de la aplicaci&oacute;n con informaci&oacute;n acerca de las correcciones hechas a las bandas.</span></p><p class="c3"><span class="c6">&nbsp;</span></p><p class="c3 c5"><a name="h.cm835e-wfzzyd"></a><span class="c0">Cabecera de la imagen</span></p><p class="c3"><img height="328.0" src="images/image4.png" width="658.0"></p><p class="c3"><span class="c6">Pantalla mostrando la cabecera de la imagen en crudo y algunos datos levantados de &eacute;sta.</span></p><hr class="c24"><div><p class="c3"><a href="#ftnt_ref1" name="ftnt1">[1]</a><span class="c6 c19">Si en vez de reflactancia quisiera ajustar para ver la imagen en radiancia o en radiancia con correcci&oacute;n del efecto rayleigh, tambi&eacute;n se deben obtener el m&aacute;ximo y m&iacute;nimo corregido de cada banda y los de la imagen. A continuaci&oacute;n se opera de la misma forma.</span></p></div></body></html>